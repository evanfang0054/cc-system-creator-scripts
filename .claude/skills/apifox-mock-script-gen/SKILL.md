---
name: apifox-mock-script-gen
description: |
  ç”Ÿæˆ Apifox Mock è„šæœ¬ã€‚æ”¯æŒåˆ†é¡µ/TokenéªŒè¯/å¼‚å¸¸/å»¶è¿Ÿ/æ ¡éªŒã€‚

  è§¦å‘è¯ï¼š
  - "ç”Ÿæˆ[xxx]æ¥å£çš„ mock è„šæœ¬"
  - "/api/... mock è„šæœ¬"
  - "ä¸ºæ¥å£ xxx ç¼–å†™ mock è„šæœ¬"

  æ ¸å¿ƒåŸåˆ™ï¼šå¿…é¡»å…ˆè·å– API æ–‡æ¡£ï¼Œä¸¥æ ¼æŒ‰ç±»å‹ç”Ÿæˆ Mock æ•°æ®ã€‚
---

# Apifox Mock è„šæœ¬ç”Ÿæˆå™¨

## æ ¸å¿ƒåŸåˆ™

> âš ï¸ **æ— æ–‡æ¡£ä¸ç”Ÿæˆï¼å¿…é¡»å…ˆè·å– API æ–‡æ¡£ï¼Œæ‰èƒ½ç¼–å†™ Mock è„šæœ¬ã€‚**

## åæ¨¡å¼è­¦ç¤ºï¼ˆç¦æ­¢è¡Œä¸ºï¼‰

### åæ¨¡å¼1ï¼šå‡­ç»éªŒçŒœæµ‹æ•°æ®ç»“æ„
```
âŒ å¬åˆ°"è¥ä¸šæ—¶é—´"å°±è®¤ä¸ºæ˜¯ object {monday: "5-18"}
âœ… å¿…é¡»å…ˆæŸ¥çœ‹æ–‡æ¡£ï¼Œç¡®è®¤æ˜¯ array è¿˜æ˜¯ object
```

### åæ¨¡å¼2ï¼šè·³è¿‡æ–‡æ¡£è·å–æ­¥éª¤
```
âŒ ç”¨æˆ·æè¿°éœ€æ±‚åç›´æ¥ç”Ÿæˆä»£ç 
âœ… å¿…é¡»å…ˆè°ƒç”¨ apifox_get_api_detail è·å–æ–‡æ¡£
```

### åæ¨¡å¼3ï¼šå¿½ç•¥åµŒå¥—ç±»å‹
```
âŒ åªæ£€æŸ¥é¡¶å±‚å­—æ®µ $.data.businessHours çš„ç±»å‹
âœ… å¿…é¡»æ£€æŸ¥åµŒå¥—å­—æ®µ $.data.businessHours[0].day çš„ç±»å‹
```

## æ‰§è¡Œæµç¨‹ï¼ˆå¼ºåˆ¶é¡ºåºï¼‰

### ç¬¬ä¸€é˜¶æ®µï¼šä¿¡æ¯æ”¶é›† ğŸ”´ [å¿…é¡»å…ˆå®Œæˆ]

```markdown
1. ğŸ”´ å¼ºåˆ¶ï¼šè°ƒç”¨ mcp__apifox-api-docs-mcp__apifox_get_api_list
   â””â”€ å¦‚æœå¤±è´¥ï¼Œåœæ­¢å¹¶æŠ¥é”™ï¼š"æ— æ³•è·å–æ¥å£åˆ—è¡¨"

2. ğŸ”´ å¼ºåˆ¶ï¼šåŒ¹é…ç›®æ ‡æ¥å£å¹¶è·å– apiId
   â””â”€ å¦‚æœæ‰¾ä¸åˆ°ï¼Œåœæ­¢å¹¶æŠ¥é”™ï¼š"æœªæ‰¾åˆ°ç›®æ ‡æ¥å£"

3. ğŸ”´ å¼ºåˆ¶ï¼šè°ƒç”¨ mcp__apifox-api-docs-mcp__apifox_get_api_detail
   â””â”€ å¦‚æœå¤±è´¥ï¼Œåœæ­¢å¹¶æŠ¥é”™ï¼š"æ— æ³•è·å–æ¥å£è¯¦æƒ…"

4. ğŸ”´ å¼ºåˆ¶ï¼šæå–ç±»å‹å®šä¹‰å¹¶åˆ›å»ºæ˜ å°„è¡¨
   â””â”€ éå†æ‰€æœ‰å­—æ®µï¼Œè®°å½•è·¯å¾„å’Œç±»å‹
```

### ç¬¬äºŒé˜¶æ®µï¼šéœ€æ±‚ç¡®è®¤ï¼ˆå¯é€‰ï¼‰

åœ¨è·å–æ–‡æ¡£åï¼Œå‘ç”¨æˆ·ç¡®è®¤ï¼š
- [ ] æ˜¯å¦éœ€è¦åˆ†é¡µæ”¯æŒï¼Ÿ
- [ ] æ˜¯å¦éœ€è¦ Token éªŒè¯ï¼Ÿ
- [ ] æ˜¯å¦éœ€è¦æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿï¼Ÿ
- [ ] æ˜¯å¦éœ€è¦å¼‚å¸¸åœºæ™¯ï¼ˆ404ã€500 ç­‰ï¼‰ï¼Ÿ
- [ ] æ˜¯å¦éœ€è¦å‚æ•°æ ¡éªŒé€»è¾‘ï¼Ÿ

### ç¬¬ä¸‰é˜¶æ®µï¼šè„šæœ¬ç”Ÿæˆï¼ˆåŸºäºæ–‡æ¡£ï¼‰

```markdown
1. å‚ç…§ç±»å‹æ˜ å°„è¡¨ç”Ÿæˆ Mock æ•°æ®
2. æ ¹æ®éœ€æ±‚é€‰æ‹©ä»£ç æ¨¡å¼ï¼ˆè§ references/code-patterns.mdï¼‰
3. ä¸ºæ¯ä¸ªå­—æ®µæ·»åŠ ç±»å‹æ³¨é‡Š
```

### ç¬¬å››é˜¶æ®µï¼šè´¨é‡éªŒè¯ï¼ˆé€å­—æ®µæ£€æŸ¥ï¼‰

```markdown
âœ“ æ­¥éª¤1ï¼šéªŒè¯ API è°ƒç”¨æ–¹å¼ï¼ˆä½¿ç”¨ fox. å‰ç¼€ï¼‰
âœ“ æ­¥éª¤2ï¼šéªŒè¯å‡½æ•°è°ƒç”¨ï¼ˆhandleRequest() è¢«è°ƒç”¨ï¼‰
âœ“ æ­¥éª¤3ï¼šğŸ”´ é€å­—æ®µéªŒè¯ç±»å‹ï¼ˆå¯¹ç…§ç±»å‹æ˜ å°„è¡¨ï¼‰
âœ“ æ­¥éª¤4ï¼šéªŒè¯åµŒå¥—ç±»å‹ï¼ˆarray å…ƒç´ ã€object å­—æ®µï¼‰
âœ“ æ­¥éª¤5ï¼šéªŒè¯å¿…å¡«å­—æ®µï¼ˆæœ‰é»˜è®¤å€¼ï¼‰
âœ“ æ­¥éª¤6ï¼šéªŒè¯æ³¨é‡Šå®Œæ•´æ€§
```

## ç±»å‹æ˜ å°„è¡¨åˆ›å»ºæµç¨‹

ä» API æ–‡æ¡£æå–ç±»å‹åï¼Œåˆ›å»ºç±»å‹æ˜ å°„è¡¨ï¼š

```javascript
// ä» API æ–‡æ¡£æå–çš„ç±»å‹å®šä¹‰
var typeMapping = {
  // åŸºæœ¬ç±»å‹
  '$.data.code': 'integer',
  '$.data.msg': 'string',
  '$..data.id': 'integer',

  // å¯¹è±¡ç±»å‹
  '$.data.description': 'object',
  '$.data.description.title': 'string',

  // æ•°ç»„ç±»å‹
  '$.data.images': 'array',
  '$.data.images[0]': 'string',

  // åµŒå¥—æ•°ç»„å¯¹è±¡
  '$.data.businessHours': 'array',
  '$.data.businessHours[0]': 'object',
  '$.data.businessHours[0].day': 'integer',
  '$.data.businessHours[0].open': 'string'
};
```

## æ•°æ®ç±»å‹ä¸¥æ ¼åŒ¹é…

| æ–‡æ¡£ç±»å‹ | JavaScript ç±»å‹ | Mock ç¤ºä¾‹ |
|---------|----------------|----------|
| `string` | String | `"æµ‹è¯•æ–‡æœ¬"` |
| `integer` | Number (æ•´æ•°) | `123` |
| `number` | Number (æµ®ç‚¹) | `123.45` |
| `boolean` | Boolean | `true` |
| `array` | Array | `[1, 2, 3]` |
| `object` | Object | `{ key: 'value' }` |

## ç¡¬çº¦æŸï¼ˆå¿…é¡»éµå¾ªï¼‰

### 1. API è°ƒç”¨è§„èŒƒ
```javascript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ fox. API
var responseJson = fox.mockResponse.json();
fox.mockResponse.setBody(responseJson);

// âŒ é”™è¯¯ï¼šä½¿ç”¨ä¸å­˜åœ¨çš„ API
response.json(data);
res.send(data);
```

### 2. å‚æ•°è·å–ç­–ç•¥

| HTTP æ–¹æ³• | å‚æ•°ä½ç½® | æ­£ç¡®çš„ API |
|----------|---------|-----------|
| GET | Query å‚æ•° | `fox.mockRequest.getParam(key)` |
| POST | JSON Body | `fox.mockRequest.body.key` |
| ALL | Headers | `fox.mockRequest.headers.get(key)` |
| ALL | Cookies | `fox.mockRequest.cookies.get(key)` |

### 3. å‡½æ•°è°ƒç”¨è¦æ±‚
```javascript
// âœ… æ­£ç¡®ï¼šå®šä¹‰å¹¶æ‰‹åŠ¨è°ƒç”¨
var handleRequest = function() {
  // é€»è¾‘ä»£ç 
};
handleRequest();

// âŒ é”™è¯¯ï¼šä½¿ç”¨å‚æ•°åŒ–å‡½æ•°ï¼ˆä¸ä¼šè¢«æ‰§è¡Œï¼‰
function handleMockRequest(req, res) {
  // é€»è¾‘ä»£ç 
}
```

## æ ‡å‡†æ¨¡æ¿

### åŸºç¡€ç»“æ„
```javascript
var MockJs = require('mockjs');

var handleRequest = function() {
  var responseJson = fox.mockResponse.json();

  // GET è¯·æ±‚ï¼šè·å– Query å‚æ•°
  var page = fox.mockRequest.getParam('page') || '1';

  // POST è¯·æ±‚ï¼šè·å– JSON Body
  var body = fox.mockRequest.body || {};

  responseJson.code = 0;
  responseJson.msg = 'success';
  responseJson.data = {
    page: page,
    moduleId: body.module || 1
  };

  fox.mockResponse.setBody(responseJson);
  fox.mockResponse.setDelay(300);
};

handleRequest();
```

## è´¨é‡æ£€æŸ¥æ¸…å•ï¼ˆç”Ÿæˆå‰å¿…æŸ¥ï¼‰

### é˜¶æ®µ0ï¼šæ–‡æ¡£å®Œæ•´æ€§æ£€æŸ¥ ğŸ”´ [å‰ç½®æ¡ä»¶]
- [ ] å·²æˆåŠŸè°ƒç”¨ `apifox_get_api_list` å¹¶è·å–æ¥å£åˆ—è¡¨
- [ ] å·²æˆåŠŸè°ƒç”¨ `apifox_get_api_detail` å¹¶è·å–å®Œæ•´æ–‡æ¡£
- [ ] å·²ä»æ–‡æ¡£ä¸­æå–æ‰€æœ‰å­—æ®µçš„ç±»å‹å®šä¹‰
- [ ] å·²åˆ›å»ºç±»å‹æ˜ å°„è¡¨ï¼ˆå­—æ®µè·¯å¾„ â†’ ç±»å‹ï¼‰
- [ ] å¦‚æœä»¥ä¸Šä»»ä½•ä¸€é¡¹æœªå®Œæˆï¼Œ**åœæ­¢ç”Ÿæˆå¹¶æŠ¥é”™**

### é˜¶æ®µ1ï¼šè„šæœ¬è§„èŒƒæ£€æŸ¥
- [ ] ä½¿ç”¨ `fox.mockResponse.json()` è·å–å“åº”å¯¹è±¡
- [ ] ä½¿ç”¨ `fox.mockResponse.setBody()` è®¾ç½®å“åº”
- [ ] å®šä¹‰ `handleRequest()` å‡½æ•°å¹¶åœ¨æœ«å°¾è°ƒç”¨
- [ ] ä¸ä½¿ç”¨ `(req, res)` å‚æ•°æ¨¡å¼
- [ ] æ‰€æœ‰ API è°ƒç”¨éƒ½ä½¿ç”¨ `fox.` å‰ç¼€

### é˜¶æ®µ2ï¼šæ•°æ®ç±»å‹æ£€æŸ¥ ğŸ”´ [æ ¸å¿ƒæ£€æŸ¥]
- [ ] é¡¶å±‚å­—æ®µç±»å‹ä¸æ–‡æ¡£ä¸€è‡´
- [ ] åµŒå¥—å¯¹è±¡å­—æ®µç±»å‹ä¸æ–‡æ¡£ä¸€è‡´
- [ ] æ•°ç»„å…ƒç´ ç±»å‹ä¸æ–‡æ¡£ä¸€è‡´
- [ ] æ·±å±‚åµŒå¥—ç±»å‹æ­£ç¡®ï¼ˆå¦‚ `$.data.items[0].user.id`ï¼‰
- [ ] ç‰¹æ®Šç±»å‹æ­£ç¡®ï¼ˆinteger ç”¨æ•°å­—è€Œéå­—ç¬¦ä¸²ï¼‰

### é˜¶æ®µ3ï¼šåŠŸèƒ½å®Œæ•´æ€§æ£€æŸ¥
- [ ] æ ¹æ®éœ€æ±‚æ·»åŠ äº†åˆ†é¡µé€»è¾‘
- [ ] æ ¹æ®éœ€æ±‚æ·»åŠ äº† Token éªŒè¯
- [ ] æ ¹æ®éœ€æ±‚æ·»åŠ äº†å¼‚å¸¸åœºæ™¯
- [ ] æ ¹æ®éœ€æ±‚æ·»åŠ äº†å»¶è¿Ÿæ¨¡æ‹Ÿ
- [ ] ä»£ç åŒ…å«å¿…è¦çš„æ³¨é‡Šè¯´æ˜

## è¾“å‡ºæ ¼å¼è¦æ±‚

```javascript
// 1. å¼•å…¥ä¾èµ–ï¼ˆå¦‚éœ€è¦ï¼‰
var MockJs = require('mockjs');

// 2. ä¸»å¤„ç†å‡½æ•°
var handleRequest = function() {
  // 2.1 è·å–å“åº”å¯¹è±¡
  var responseJson = fox.mockResponse.json();

  // 2.2 è·å–è¯·æ±‚å‚æ•°ï¼ˆæ ¹æ® HTTP æ–¹æ³•é€‰æ‹©æ­£ç¡®æ–¹å¼ï¼‰
  var param = fox.mockRequest.getParam('key');  // GET
  // var body = fox.mockRequest.body.key;       // POST

  // 2.3 ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼ˆåˆ†é¡µã€Tokenã€å¼‚å¸¸ç­‰ï¼‰

  // 2.4 è®¾ç½®å“åº”æ•°æ®
  responseJson.code = 0;
  responseJson.msg = 'success';
  responseJson.data = { /* Mock æ•°æ® */ };

  // 2.5 è¿”å›å“åº”
  fox.mockResponse.setBody(responseJson);
  fox.mockResponse.setDelay(500);  // å¯é€‰
};

// 3. æ‰‹åŠ¨è°ƒç”¨å‡½æ•°
handleRequest();
```

## å‚è€ƒèµ„æº

### æ ¸å¿ƒæ–‡æ¡£
- **ä»£ç æ¨¡å¼åº“**ï¼š`references/code-patterns.md` - åˆ†é¡µã€Tokenã€å¼‚å¸¸ç­‰å¸¸è§åœºæ™¯çš„ä»£ç æ¨¡å¼
- **é”™è¯¯æ¡ˆä¾‹åº“**ï¼š`references/error-cases.md` - å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ
- **API å‚è€ƒ**ï¼š`references/api-reference.md` - å®Œæ•´çš„ API æ–‡æ¡£
- **Mock è„šæœ¬æŒ‡å—**ï¼š`references/mock_script_guide.md` - Apifox å®˜æ–¹æ–‡æ¡£

### MCP å·¥å…·
- `mcp__apifox-api-docs-mcp__apifox_get_api_list` - è·å–æ¥å£åˆ—è¡¨
- `mcp__apifox-api-docs-mcp__apifox_get_api_detail` - è·å–æ¥å£è¯¦æƒ…
- `mcp__apifox-api-docs-mcp__apifox_health_check` - å¥åº·æ£€æŸ¥

### ä½¿ç”¨åœºæ™¯æŒ‡å—

**ä½•æ—¶è¯»å– code-patterns.mdï¼Ÿ**
- éœ€è¦å®ç°åˆ†é¡µé€»è¾‘æ—¶
- éœ€è¦æ·»åŠ  Token éªŒè¯æ—¶
- éœ€è¦æ¨¡æ‹Ÿå¼‚å¸¸åœºæ™¯æ—¶
- éœ€è¦ä½¿ç”¨ Mock.js ç”Ÿæˆéšæœºæ•°æ®æ—¶

**ä½•æ—¶è¯»å– error-cases.mdï¼Ÿ**
- è„šæœ¬ä¸ç”Ÿæ•ˆæ—¶
- è·å–ä¸åˆ°å‚æ•°æ—¶
- å‡ºç°ç±»å‹é”™è¯¯æ—¶
- é‡åˆ°è¯­æ³•é”™è¯¯æ—¶

**ä½•æ—¶è¯»å– api-reference.mdï¼Ÿ**
- ä¸ç¡®å®šä½¿ç”¨å“ªä¸ª API æ—¶
- éœ€è¦æŸ¥è¯¢ API å‚æ•°æ—¶
- éœ€è¦äº†è§£æ•°æ®ç±»å‹æ˜ å°„æ—¶
- éœ€è¦æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹æ—¶
