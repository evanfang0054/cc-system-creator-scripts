# 步骤4：代码整合与PRD验收

**触发条件**：'current_step = 4'，已完成数据和交互逻辑设计

**行动**:

1. **调用代码整合专家代理**
   - 启动 `booking-code-integrator` 代理来执行专业的代码整合和PRD验收工作
   - 该代理将自动执行以下操作：

2. **完整代码整合生成**
   - 代理会将前面步骤设计的数据层逻辑和UI交互逻辑完整整合到静态模板中
   - 确保保留原有的样式类名（Tailwind CSS）和DOM结构
   - 移除所有TODO注释，替换为实际的业务逻辑代码

3. **核心功能实现**
   - 代理会实现以下关键功能：
     * **数据获取与状态管理**：API调用函数、useBookingStore完善、错误处理
     - **表单交互逻辑**：日期选择器联动、动态字段显示隐藏、表单验证
     - **用户交互处理**：输入框事件处理、表单提交、跳转逻辑

4. **PRD功能全面验收**
   - 代理会再次仔细阅读PRD文档，逐条核对Gherkin Scenarios：
     * [ ] Scenario: 初始化预订表单 - 页面加载、资源详情获取、Policy配置显示
     - [ ] Scenario: 选择访问日期 - 日期选择器工作、时段数据获取、时间选择器重置
     - [ ] Scenario: 选择进入时间 - 时间选择器渲染、状态更新、格式化显示
     - [ ] Scenario: 动态填写乘客姓名 - 输入框按需显示、最多N个乘客支持
     - [ ] Scenario: 动态字段必填验证 - 字段必填状态设置、实时验证、错误提示
     - [ ] Scenario: 数据持久化 - Store保存、页面刷新恢复、数据格式验证
     - [ ] Scenario: 表单验证和按钮状态 - Continue按钮智能控制、必填验证
     - [ ] Scenario: 跳转到结账页面 - 验证通过跳转、JSBridge参数传递

5. **代码质量检查**
   - 代理会确保所有导入和依赖的正确性
   - 检查TypeScript类型定义的完整性
   - 验证组件属性的正确传递

**输出目标**：

- 通过专家代理生成完整的、可运行的booking页面代码
- 获得详细的PRD验收报告，确保所有业务功能按规范实现
- 为下一步的测试验收提供完整的代码基础
