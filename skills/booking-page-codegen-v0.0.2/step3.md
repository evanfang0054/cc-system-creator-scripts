# 第 3 步：UI 组件与用户交互

## 目标

基于第 2 步的数据层设计，设计完整的用户交互逻辑和组件实现。

## 行动

### 1. 组件文档研究

**关键**: 在未查阅文档的情况下，永远不要假设组件属性。

对于模板中使用的每个 `atom-ui-mobile` 组件：

```bash
# 使用 MCP 获取组件 API 文档
mcp_retrieve-knowledgeBase [组件名称]
```

**需要的组件文档**:
- 日期选择器组件
- 时间选择器组件
- 表单输入组件
- 按钮组件
- 模态框/对话框组件
- 加载组件

### 2. JSBridge 集成

- 完全阅读: [references/jsbridge.md](references/jsbridge.md)
- 掌握原生交互方法：
  - 用于页面导航的 `openWebview`
  - 页面关闭和返回导航
  - 跨页面数据持久化
  - 原生应用通信模式

### 3. 交互逻辑设计

#### 动态表单行为
- 实现由 `PrebookingPolicy` 驱动的字段可见性
- 动态必填字段验证
- 条件表单部分显示/隐藏
- 实时验证反馈

#### 日期和时间选择
- 日期选择器 → 时间重置 → 时间段加载流程
- 日期和时间之间的级联验证
- 优雅处理不可用日期/时间
- 在 API 调用期间显示加载状态

#### 表单验证和提交
- "继续到结账" 按钮状态管理
- 全面的表单验证逻辑
- 错误消息显示和定位
- 表单提交处理和成功反馈

#### 导航和数据流
- 导航前在存储中持久化数据
- 页面转换的 JSBridge 调用
- 返回导航处理
- 组件卸载时的数据清理

### 4. 用户体验增强

- 异步操作的加载状态
- 错误处理和恢复机制
- 可访问性考虑
- 移动端特定交互模式
- 触摸手势支持

## 验证标准

✅ **组件文档完成**：
- 所有组件 API 已理解
- 属性和方法已记录
- 使用模式已澄清

✅ **JSBridge 集成已规划**：
- 原生通信方法已理解
- 导航流程已设计
- 数据持久化策略已定义

✅ **交互逻辑已设计**：
- 表单验证逻辑完成
- 日期时间级联逻辑已规划
- 按钮状态管理已定义
- 导航流程已映射

✅ **UX 增强已考虑**：
- 加载状态已规划
- 错误处理已设计
- 可访问性已处理

## 下一步

继续 [第 4 步](step4.md)：代码整合与验证

**输出确认**: "UI 交互设计完成 - 准备进行代码整合"
